---
import CourseLayout from '../../layouts/CourseLayout.astro';
import { getCollection } from 'astro:content';

// Get the main course data from the content collection
const courseGuide = await getCollection('guides', ({ slug }) => slug === 'co-ban');
if (!courseGuide || courseGuide.length === 0) {
  throw new Error("Course guide 'co-ban' not found in src/content/guides/");
}
const guideData = courseGuide[0].data;
const { Content } = await courseGuide[0].render();

// Transform guide data to course structure expected by CourseLayout
const basicCourse = {
  id: 'co-ban',
  title: guideData.title,
  level: guideData.level || 'Cơ bản',
  description: guideData.description || '',
  duration: guideData.duration || '',
  students: guideData.students || 0,
  rating: guideData.rating || 0,
  modules: guideData.modules || []
};

// Theme configuration for basic course
const basicTheme = {
  emoji: '🌱',
  colors: {
    primary: 'green',
    secondary: 'blue',
    badge: 'green',
    hover: {
      primary: 'green',
      secondary: 'blue'
    }
  }
};

// Prerequisite section content
const prerequisiteContent = `
  <div class="flex items-start">
    <div class="text-2xl mr-4">💡</div>
    <div>
      <h3 class="text-lg font-bold text-green-800 mb-2">Dành cho người mới bắt đầu</h3>
      <p class="text-green-700 mb-4">
        Khóa học này được thiết kế cho những ai chưa từng sử dụng Anki hoặc mới bắt đầu. Không cần kiến thức nền tảng gì trước đó.
      </p>
      <div class="inline-flex items-center text-green-800 font-semibold">
        <svg class="mr-2 w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
        </svg>
        Phù hợp cho người mới bắt đầu
      </div>
    </div>
  </div>
`;

// Next course section content
const nextCourseContent = `
  <h2 class="text-3xl font-bold text-gray-900 mb-4">
    Tiếp tục hành trình học tập
  </h2>
  <p class="text-gray-600 mb-8">
    Sau khi hoàn thành khóa cơ bản, hãy thử thách bản thân với khóa học nâng cao
  </p>
  
  <div class="bg-white rounded-xl shadow-lg p-8 border border-gray-200">
    <div class="text-4xl mb-4">🚀</div>
    <h3 class="text-2xl font-bold text-gray-900 mb-2">Khóa học Anki Nâng cao</h3>
    <p class="text-gray-600 mb-6">
      Khám phá các tính năng nâng cao và kỹ thuật chuyên sâu để tối ưu hóa việc học
    </p>
    <div class="flex justify-center gap-4">
      <a 
        href="/guides/nang-cao"
        class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors"
      >
        Khám phá khóa Nâng cao
      </a>
      <a 
        href="/guides"
        class="border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:border-blue-500 hover:text-blue-600 transition-colors"
      >
        Xem tất cả khóa học
      </a>
    </div>
  </div>
`;
---

<CourseLayout 
  course={basicCourse}
  theme={basicTheme}
  prerequisiteSection={{
    show: true,
    content: prerequisiteContent
  }}
  nextCourseSection={{
    show: true,
    content: nextCourseContent
  }}
>
  <Content />
</CourseLayout>
